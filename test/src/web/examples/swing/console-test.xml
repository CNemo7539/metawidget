<project name="swing-console-test" default="test-all">

	<property file="../../../../build.properties" />

	<path id="webtest.path.id">
		<pathelement location="${webtest.dir}/lib"/>
		<fileset dir="${webtest.dir}/lib" includes="*.jar"/>
		<fileset dir="${tomcat.dir}/webapps/ROOT/live-demo" includes="*.jar"/>
		<fileset dir="../../../../lib" includes="emma.jar"/>
	</path>
	
    <taskdef resource="webtest.taskdef" loaderref="webtest.loader" classpathref="webtest.path.id"/>

	<!-- Test Console Loads -->

	<target name="test-all">
		<webtest name="test-loads">
			<config resultpath="../../../../../${build.dir}"/>
			<steps>
				<invoke url="file://${tomcat.dir}/webapps/ROOT/live-demo/demo.html" />

				<!-- Note this makes a new GroovyConsoleApplet, it does not test the -->
				<!-- one actually on the page. We couldn't figure out how to get testing with appletRunner  -->
				<!-- working (see http://lists.canoo.com/pipermail/webtest/2008q2/010687.html)              -->
				
				<groovy>
					def applet = new org.metawidget.example.swing.console.GroovyConsoleApplet();
					step.setWebtestProperty( 'componentCount', String.valueOf( applet.getComponent( 0 ).getComponentCount() ));
				</groovy>
				<verifyProperty name="componentCount" text="2"/>
			</steps>
		</webtest>
	</target>
</project>
