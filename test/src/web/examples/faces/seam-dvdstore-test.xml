<project name="faces-seam-dvdstore-test" default="test-all">

	<property file="../../../../../build.properties" />
	<property file="../../../../build.properties" />
	<import file="${webtest.dir}/webtest.xml" />

	<!-- Test Search Screen -->

	<target name="test-all" depends="wt.defineTasks">
		<webtest name="test-all">
			<config resultpath="../../../../../${build.dir}"/>
			<steps>
				<invoke url="${webtest.url}/seam-dvdstore/home" />
				<verifyTitle text="JBoss DVD Store" />
				<clickLink label="Create Account" />
				<clickButton label="Next" />
					
				<verifyXPath xpath="normalize-space(//*[@id='table-customerUserName-cell']/span)" text="User name: Validation Error: Value is required."/>
				<verifyXPath xpath="normalize-space(//*[@id='table-customerPassword-cell']/span)" text="Password: Validation Error: Value is required."/>
				<verifyXPath xpath="normalize-space(//*[@id='table-editCustomerPasswordVerify-cell']/span)" text="Password verify: Validation Error: Value is required."/>
				<setInputField name="NewAccountForm:customerUserName" value="NewUser" />
				<setInputField name="NewAccountForm:customerPassword" value="New" />
				<clickButton label="Next" />
				
				<verifyXPath xpath="normalize-space(//*[@id='table-customerPassword-cell']/span)" text="Password: Validation Error: Value is less than allowable minimum of '6'"/>
				<setInputField name="NewAccountForm:customerPassword" value="New Password" />
				<setInputField name="NewAccountForm:editCustomerPasswordVerify" value="New Password" />
				<clickButton label="Next" />
				<clickButton label="Next" />

				<verifyXPath xpath="normalize-space(//*[@id='table-customerAddress1-cell'])" text="Address 1: Validation Error: Value is required."/>
				<verifyXPath xpath="normalize-space(//*[@id='table-customerAddress2-cell'])" text="Address 2: Validation Error: Value is required."/>
				<verifyXPath xpath="normalize-space(//*[@id='table-customerCity-cell'])" text="City: Validation Error: Value is required."/>
				<verifyXPath xpath="normalize-space(//*[@id='table-customerState-cell'])" text="State: Validation Error: Value is required."/>
				<verifyXPath xpath="normalize-space(//*[@id='table-customerZip-cell'])" text="Zip: Validation Error: Value is required."/>
				<setInputField name="NewAccountForm:customerFirstName" value="New" />
				<setInputField name="NewAccountForm:customerLastName" value="User" />
				<setInputField name="NewAccountForm:customerAddress1" value="Apt 2" />
				<setInputField name="NewAccountForm:customerAddress2" value="11/36-66 User Av" />
				<setInputField name="NewAccountForm:customerCity" value="Userton" />
				<setInputField name="NewAccountForm:customerState" value="U" />
				<setInputField name="NewAccountForm:customerZip" value="1" />
				<setInputField name="NewAccountForm:customerEmail" value="user" />
				<clickButton label="Next" />

				<!-- E-mail validation only works the second time you press 'Next', because of JBSEAM-3251 -->
				
								
				<verifyXPath xpath="normalize-space(//*[@id='table-customerState-cell'])" text="length must be between 2 and 2"/>
				<verifyXPath xpath="normalize-space(//*[@id='table-customerZip-cell'])" text="length must be between 5 and 10"/>
				<verifyXPath xpath="normalize-space(//*[@id='table-customerEmail-cell'])" text="not a well-formed email address"/>
				<clickButton label="Next" />
				
				<setInputField name="NewAccountForm:customerState" value="UR" />
				<setInputField name="NewAccountForm:customerZip" value="12345" />
				<setInputField name="NewAccountForm:customerEmail" value="user@user.com" />
				<clickButton label="Next" />
								
				<verifySelectField name="NewAccountForm:customerCreditCardType" value="1"/>
				<setSelectField name="NewAccountForm:customerCreditCardType" value="2"/>				
				<clickButton label="Next" />
				<clickLink label="start shopping" />
				
				<clickLink label="Pulp Fiction" />
				<clickButton xpath="//input[@value='Add to Cart']" />
				<clickButton label="Checkout" />
				<clickButton label="Purchase" />
				<clickButton label="Cancel" />
				
				<clickLink label="The Terminal" />
				<clickButton xpath="//input[@value='Add to Cart']" />
				<clickButton label="Checkout" />
				<clickButton label="Purchase" />
				<clickButton label="Purchase" />
				<verifyXPath xpath="contains(/html/body/div/div[3]/div[3]/p, 'Thank you for ordering.')"/>				
				<verifyXPath xpath="normalize-space(//*[@id='orderdetail:TotalAmountValue'])" text="$16.23"/>
				<verifyXPath xpath="normalize-space(//*[@id='orderdetail:CreditCartType'])" text="Visa"/>
				
			</steps>
		</webtest>
	</target>

</project>
