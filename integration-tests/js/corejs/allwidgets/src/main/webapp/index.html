<!DOCTYPE html>
<html ng-app="allWidgets">
	<head>
		<meta charset="utf-8"/>
		<title>All Widgets (Metawidget CoreJS Test)</title>
		<script src="lib/metawidget/core/metawidget.js" type="text/javascript"></script>
		<script src="lib/metawidget/core/metawidget-inspectors.js" type="text/javascript"></script>
		<script src="lib/metawidget/core/metawidget-widgetbuilders.js" type="text/javascript"></script>
		<script src="lib/metawidget/core/metawidget-widgetprocessors.js" type="text/javascript"></script>
		<script src="lib/metawidget/core/metawidget-layouts.js" type="text/javascript"></script>
		<script src="lib/metawidget/core/metawidget-utils.js" type="text/javascript"></script>
		<script src="js/allwidgets.js" type="text/javascript"></script>
	</head>
	<body>
	
		<script type="text/javascript">
						
			var mw = new metawidget.Metawidget( {
	
				inspector: new metawidget.inspector.CompositeInspector( [ function( toInspect, type ) {
	
					switch ( type ) {
						case 'allWidgets':
							return metawidget.test.allWidgetsMetadata;
						case 'allWidgets.nestedWidgets':
							return metawidget.test.nestedWidgetsMetadata;
						case 'allWidgets.readOnlyNestedWidgets':
							return metawidget.test.nestedWidgetsMetadata;
						case 'allWidgets.nestedWidgetsDontExpand':
							return metawidget.test.nestedWidgetsMetadata;
					}					
				}, new metawidget.inspector.PropertyTypeInspector() ] )
			} );	
			mw.toInspect = allWidgets;
			mw.path = 'allWidgets';
			document.write( mw.buildWidgets().innerHTML );
			
			actions = {
				"save": function() {
					var processor = mw.getWidgetProcessor( function( widgetProcessor ) { return widgetProcessor instanceof metawidget.widgetprocessor.SimpleBindingProcessor; } );
					processor.save( mw );
					mw.readOnly = true;
					document.getElementById( 'table-allWidgets' ).innerHTML = mw.buildWidgets().innerHTML;
				}			
			}
			
			var actionsMetawidget = new metawidget.Metawidget( {
				layout: new metawidget.layout.SimpleLayout()
			} );
			actionsMetawidget.toInspect = actions;
			actionsMetawidget.path = 'actions';
			document.write( actionsMetawidget.buildWidgets().innerHTML );
		</script>
	
	</body>
</html>
